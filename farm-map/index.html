<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Farm Verification Map</title>

  <link rel="manifest" href="manifest.json">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

  <!-- Leaflet styles -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

  <!-- App styles -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

  <!-- Intro tutorial -->
  <div class="intro-overlay" id="introOverlay">
    <div class="intro-modal">
      <h2>Help verify factory farms</h2>
      <p>
        This map highlights potential animal agriculture farms. Your input helps confirm them.
      </p>
      <p>
        Tap a farm, inspect it using satellite imagery, and vote <strong>YES</strong> or <strong>NO</strong>.
      </p>
      <p>
        When finished, use <strong>Export votes</strong> to share your feedback.
      </p>
      <button id="introReady">Ready</button>
    </div>
  </div>

  <div id="map"></div>

  <!-- Menu toggle -->
  <div class="menu-toggle">
    <button id="toggleMenu" class="secondary">Map menu</button>
  </div>

  <!-- Menu panel -->
  <div class="menu-panel" id="menuPanel">
    <button id="toggleCluster" class="secondary">Disable clustering</button>
    <button id="toggleHeat" class="secondary">Show suspicious areas</button>
    <button id="toggleZones" class="secondary">High-density zones</button>
    <button id="toggleVoted" class="secondary">Show reviewed farms</button>

<div id="unvotedCounter" class="menu-meta">
  Needs review: –
</div>

    <div class="contribution-panel" id="contributionPanel">
  <div class="contribution-title">Your impact</div>

  <div class="contribution-row">
    <strong id="userTier">–</strong>
    <span id="userScore">0 points</span>
  </div>

  <div class="contribution-meta">
    <div>Votes: <span id="userVotes">0</span></div>
    <div>High-confidence: <span id="userHigh">0</span></div>
    <div>Model: <span id="modelVersion">v0.1</span></div>
  </div>
</div>


    <button id="exportVotes">Export votes</button>

    <!-- Legend -->
    <div class="legend">
      <div class="legend-title">Probability</div>
      <div class="legend-row"><div class="legend-swatch green"></div>&lt; 50%</div>
      <div class="legend-row"><div class="legend-swatch yellow"></div>50–69%</div>
      <div class="legend-row"><div class="legend-swatch orange"></div>70–89%</div>
      <div class="legend-row"><div class="legend-swatch red"></div>≥ 90%</div>
    </div>
  </div>

  <!-- NEW: Zones panel -->
  <div class="zones-panel" id="zonesPanel">
    <div class="zones-title">High-density zones</div>
    <div id="zonesList" class="zones-list">
      <!-- Filled dynamically by app.js -->
    </div>
  </div>

  <!-- Libraries -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

  <!-- App logic -->
<script src="app.js?v=0-2: zone ranking" defer></script>
</body>
</html>
